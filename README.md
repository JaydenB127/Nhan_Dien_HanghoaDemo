# AI Retail Intelligence Platform

The AI Retail Intelligence Platform is an end-to-end system that combines computer vision, deep learning, Monte Carlo simulation, and machine learning to streamline retail operations. The platform detects products on shelves in real time, forecasts demand trends, evaluates inventory risk, and recommends replenishment actions through a Streamlit dashboard.

## Key capabilities

- **Real-time product identification** using YOLOv8, OpenCV, and live video streams (USB webcams or IP cameras).
- **Demand trend forecasting** powered by an LSTM network trained on historical sales data.
- **Inventory risk analysis** via Monte Carlo simulations to estimate shortage and overstock probabilities.
- **Reorder optimization** backed by a Random Forest model that consolidates detections, forecasts, and risk metrics.
- **Interactive dashboard** that surfaces live detections, analytics, and recommended inventory actions.

## Repository layout

```
SHELF-PRODUCT-IDENTIFIER-MAIN/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ img/
â”‚   â”œâ”€â”€ detection_log.csv
â”‚   â”œâ”€â”€ sales_data.csv
â”‚   â”œâ”€â”€ risk_analysis.csv
â”‚   â””â”€â”€ recommendations.csv
â”œâ”€â”€ img/
â”‚   â”œâ”€â”€ detections/
â”‚   â”œâ”€â”€ forecast_trend.png
â”‚   â””â”€â”€ risk_histogram.png
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ yolov8_best.pt
â”‚   â”œâ”€â”€ forecast_model.h5
â”‚   â””â”€â”€ ml_optimizer.pkl
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ predict_image_product.ipynb
â”‚   â”œâ”€â”€ deep_forecast_training.ipynb
â”‚   â”œâ”€â”€ montecarlo_simulation.ipynb
â”‚   â””â”€â”€ stock_optimization.ipynb
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ realtime_identifier.py
â”‚   â”œâ”€â”€ img2vec_resnet18.py
â”‚   â”œâ”€â”€ deep_forecast.py
â”‚   â”œâ”€â”€ risk_simulation.py
â”‚   â””â”€â”€ ml_optimizer.py
â”œâ”€â”€ dashboard_app.py
â”œâ”€â”€ main.py
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

## Installation

1. Create a Python 3.9+ virtual environment.
2. Install the dependencies:

   ```bash
   pip install -r requirements.txt
   ```

3. Download or train YOLOv8 weights and place them at `models/yolov8_best.pt`.

## Usage

### 1. Real-time product detection

Run the vision pipeline with a webcam or IP camera stream:

```bash
python main.py --source 0
# or
python main.py --source http://192.168.x.x:8080/video --save
```

The application displays bounding boxes, class labels, confidence scores, total counts, and writes detections to `data/detection_log.csv`. Use `--save` to store annotated frames under `img/detections/`.

### 2. Train or refresh the forecasting model

```bash
python src/deep_forecast.py --epochs 50 --batch-size 8 --window 5
```

The script reads `data/sales_data.csv`, fits an LSTM model, saves `models/forecast_model.h5`, and exports the trend plot to `img/forecast_trend.png`.

### 3. Run Monte Carlo risk simulations

```bash
python src/risk_simulation.py --iterations 1000
```

This command ingests the latest forecast, creates 1,000 demand scenarios per product, writes the summary to `data/risk_analysis.csv`, and stores a histogram in `img/risk_histogram.png`.

### 4. Generate ML-based inventory recommendations

```bash
python src/ml_optimizer.py
```

The optimizer trains (or loads) a Random Forest model, merges detection logs, forecast signals, and risk outputs, and exports recommendations to `data/recommendations.csv`. The trained model is serialized at `models/ml_optimizer.pkl`.

### 5. Launch the Streamlit dashboard

```bash
streamlit run dashboard_app.py
```

The dashboard exposes four tabs:

- **ðŸ§ƒ Camera View** â€“ monitors real-time detection snapshots and guides starting the pipeline.
- **ðŸ“ˆ Trend Forecast** â€“ displays the demand forecast image, latest prediction, and confidence interval.
- **ðŸ“Š Risk Simulation** â€“ shows risk metrics alongside the simulated demand distribution.
- **ðŸ§© Optimization** â€“ lists machine learning recommendations and enables CSV downloads.

Use the **Retrain Model** sidebar button to trigger the entire training pipeline from within the dashboard.

## Data sources

- `data/sales_data.csv` â€“ daily sales history used for training the forecast model.
- `data/detection_log.csv` â€“ appended in real time during product detection.
- `data/risk_analysis.csv` â€“ generated by the Monte Carlo simulator.
- `data/recommendations.csv` â€“ produced by the ML optimizer.

## Notebooks

The `notebooks/` directory hosts complementary Jupyter notebooks for experimentation and further customization:

- `predict_image_product.ipynb` â€“ original image embedding workflow.
- `deep_forecast_training.ipynb` â€“ extended forecasting experiments.
- `montecarlo_simulation.ipynb` â€“ exploratory risk simulations.
- `stock_optimization.ipynb` â€“ advanced inventory optimization research.

## Testing modules individually

Each module can be executed as a standalone script for debugging or integration into other pipelines:

```bash
python src/deep_forecast.py
python src/risk_simulation.py
python src/ml_optimizer.py --train-only
```

## Contribution guidelines

- Follow PEP 8 style conventions.
- Document new functions with docstrings and maintain type hints.
- Keep models, data, and dashboards modular so that future product categories can be onboarded with minimal changes.

## License

This project retains the original MIT license.
